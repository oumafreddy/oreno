<!-- Success template for HTMX responses -->
<div class="alert alert-success" role="alert">
  <h4 class="alert-heading">Success!</h4>
  <p>Your approval request has been submitted successfully.</p>
  <hr>
  <p class="mb-0">
    {% if approval.status == 'pending' %}
      An email notification has been sent to {{ approval.approver.get_full_name|default:approval.approver.email }}.
    {% else %}
      The approval has been processed.
    {% endif %}
  </p>
</div>

<!-- Hidden div to store redirect URL for JavaScript -->
<div id="success-redirect-data" data-redirect-url="{% if redirect_url %}{{ redirect_url }}{% endif %}" style="display: none;"></div>

<script>
  // Close the modal after success
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      var modalElement = document.querySelector('.modal');
      if (modalElement) {
        var modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
        modal.hide();
      }
      
      // Read the redirect URL from the data attribute
      var redirectDataElement = document.getElementById('success-redirect-data');
      var redirectUrlValue = null;
      if (redirectDataElement) {
        redirectUrlValue = redirectDataElement.getAttribute('data-redirect-url');
      }
      
      // If we have a valid redirect URL, navigate to it
      if (redirectUrlValue && redirectUrlValue.length > 0) {
        window.location.href = redirectUrlValue;
      }
    }, 1500);
  });
</script>
