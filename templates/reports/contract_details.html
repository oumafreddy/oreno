{% extends 'base.html' %}
{% block content %}
<div class="container mt-3">
  <h2>Contract Details</h2>
  <p><strong>Organization:</strong> {{ organization.name }}</p>
  {% for c in contracts %}
  <div class="card mb-3">
    <div class="card-body">
      <h4>{{ c.title|truncatechars:60 }}</h4>
      <p><strong>ID:</strong> {{ c.contract_id }}</p>
      <p><strong>Status:</strong> {{ c.get_status_display }}</p>
      <p><strong>Type:</strong> {{ c.contract_type.name }}</p>
      <p><strong>Start:</strong> {{ c.start_date }}</p>
      <p><strong>Expiry:</strong> {{ c.expiry_date }}</p>
      <p><strong>Value:</strong> {{ c.value|floatformat:2 }}</p>
      <p><strong>Parties:</strong> {% for p in c.parties.all %}{{ p.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
      <p><strong>Description:</strong> {{ c.description|truncatechars:120 }}</p>
      <h6 class="mt-3">Milestones</h6>
      <table class="table table-sm table-striped">
        <thead><tr><th>Type</th><th>Due</th><th>Status</th></tr></thead>
        <tbody>
          {% for m in c.milestones.all %}
          <tr>
            <td>{{ m.milestone_type }}</td>
            <td>{{ m.due_date }}</td>
            <td>{{ m.get_status_display }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="3" class="text-muted">No milestones.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% empty %}
  <div class="alert alert-info">No contracts found.</div>
  {% endfor %}
</div>
{% endblock %} 