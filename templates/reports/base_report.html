<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>{{ title }} - {{ organization.name }}</title>
  <style>
    /* Professional Report Styling - Enhanced to match reference images */
    @page {
      size: A4;
      margin: 1.5cm 1cm; /* Reduced margins for more content space */
      @bottom-center {
        content: "Generated: {{ generation_timestamp|default:'' }} | {{ organization.name }}";
        font-size: 9pt;
        color: #666;
      }
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 9pt; /* Slightly smaller base font for more content */
      line-height: 1.4; /* Tighter line height */
      color: #333;
      margin: 0;
      padding: 0;
    }
    
    /* Enhanced Header Design - Matching reference images */
    .report-header { background: linear-gradient(90deg, #1e3a8a 0%, #2563eb 100%); color: white; padding: 0.5cm 0; margin-bottom: 0.5cm; }
    .header-content { display: flex; justify-content: space-between; align-items: center; padding: 0 0.5cm; }
    .header-left { font-size: 9pt; opacity: 0.9; }
    .header-right { text-align: right; }
    .organization-logo { max-height: 60px; max-width: 150px; }
    .header-separator { height: 2px; background: #2563eb; margin: 0.3cm 0; }
    
    /* Cover Page Styling */
    .cover-page { text-align: center; padding: 2cm 1.5cm; min-height: 20cm; display: flex; flex-direction: column; justify-content: space-between; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); }
    .cover-organization-logo { max-height: 100px; max-width: 250px; margin: 0 auto 0.5cm; }
    .default-logo-placeholder { background: #f8f9fa; border: 2px dashed #dee2e6; padding: 1.5cm; margin: 0 auto 0.5cm; border-radius: 8px; color: #6b7280; }
    .report-title { font-size: 20pt; color: #1e3a8a; margin: 0.5cm 0; font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
    .report-subtitle { font-size: 11pt; color: #6b7280; margin-bottom: 1.5cm; font-weight: 400; }
    .report-meta { text-align: left; margin-top: 1cm; padding: 0.8cm; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    
    .page-break { page-break-after: always; }
    
    /* Enhanced Section Headers */
    .section-header { font-size: 12pt; color: white; background: #1e3a8a; padding: 0.3cm 0.8cm; margin: 0.8cm 0 0.3cm; font-weight: 600; border-radius: 4px 4px 0 0; page-break-after: avoid; break-after: avoid; }
    .section-subheader { font-size: 11pt; color: white; background: #2563eb; padding: 0.25cm 0.8cm; margin: 0.6cm 0 0.3cm; margin-left: 0.5cm; font-weight: 600; border-radius: 4px 4px 0 0; width: calc(100% - 1cm); page-break-after: avoid; break-after: avoid; }
    .section-subsubheader { font-size: 10pt; color: white; background: #3b82f6; padding: 0.2cm 0.8cm; margin: 0.5cm 0 0.2cm; margin-left: 1cm; font-weight: 600; border-radius: 4px 4px 0 0; width: calc(100% - 2cm); page-break-after: avoid; break-after: avoid; }
    .priority-indicator { display: inline-block; background: #fbbf24; color: #000; padding: 0.15cm 0.4cm; border-radius: 4px; font-weight: 600; font-size: 9pt; margin-left: 0.5cm; }
    
    /* Tables: never spill, always wrap, avoid row splits */
    .report-table { width: 100%; border-collapse: collapse; margin: 0.5cm 0; font-size: 9pt; box-shadow: 0 1px 3px rgba(0,0,0,0.1); table-layout: fixed; }
    .report-table thead { display: table-header-group; }  /* repeat table header across pages */
    .report-table tbody { display: table-row-group; }
    .report-table th { background: #1e3a8a; color: white; padding: 6px 8px; text-align: left; font-weight: 600; border-bottom: 2px solid #2563eb; font-size: 9pt; }
    .report-table td { padding: 6px 8px; border-bottom: 1px solid #e5e7eb; vertical-align: top; font-size: 9pt; }
    .report-table th, .report-table td { word-break: break-word; overflow-wrap: anywhere; white-space: normal; }
    .report-table tr { page-break-inside: avoid; break-inside: avoid; }
    img { max-width: 100%; height: auto; }
    
    /* Status & Risk */
    .status-badge { padding: 3px 8px; border-radius: 4px; font-size: 8pt; font-weight: 600; display: inline-block; text-align: center; min-width: 70px; }
    .status-active { background: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
    .status-inactive { background: #fef2f2; color: #991b1b; border: 1px solid #fecaca; }
    .status-pending { background: #fef3c7; color: #92400e; border: 1px solid #fed7aa; }
    .status-draft { background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; }
    .status-approved { background: #dbeafe; color: #1e40af; border: 1px solid #bfdbfe; }
    .status-rejected { background: #fee2e2; color: #dc2626; border: 1px solid #fecaca; }
    .risk-level { padding: 3px 8px; border-radius: 4px; font-size: 8pt; font-weight: 600; display: inline-block; text-align: center; min-width: 70px; }
    .risk-high { background: #fee2e2; color: #dc2626; border: 1px solid #fecaca; }
    .risk-medium { background: #fef3c7; color: #d97706; border: 1px solid #fed7aa; }
    .risk-low { background: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
    
    /* Cards & Stats */
    .report-card { background: white; border: 1px solid #e5e7eb; border-radius: 6px; padding: 0.8cm; margin: 0.6cm 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1); break-inside: avoid; page-break-inside: avoid; }
    .report-card h3 { color: #1e3a8a; font-size: 11pt; margin-bottom: 0.4cm; padding-bottom: 0.2cm; border-bottom: 2px solid #2563eb; page-break-after: avoid; break-after: avoid; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.6cm; margin: 0.6cm 0; }
    .stat-item { background: white; border: 1px solid #e5e7eb; border-radius: 6px; padding: 0.6cm; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .stat-number { font-size: 16pt; font-weight: 700; color: #2563eb; margin-bottom: 0.2cm; }
    .stat-label { font-size: 8pt; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }
    
    /* Fields */
    .field-label { font-weight: 600; color: #374151; background: #f9fafb; padding: 0.2cm 0.4cm; border-left: 3px solid #2563eb; margin-bottom: 0.15cm; font-size: 9pt; }
    .field-value { background: #f8fafc; padding: 0.3cm; border-radius: 4px; margin-bottom: 0.3cm; border-left: 3px solid #e2e8f0; font-size: 9pt; }
    
    /* Keep header with following card */
    .section-subheader + .report-card,
    .section-header + .report-card { break-inside: avoid; page-break-inside: avoid; }
    
    /* Compact spacing for better space utilization */
    .report-card + .report-card { margin-top: 0.4cm; }
    .section-header + .report-card { margin-top: 0.3cm; }
    .section-subheader + .report-card { margin-top: 0.2cm; }
    
    /* Reduce spacing in lists and paragraphs */
    p { margin: 0.2cm 0; }
    ul, ol { margin: 0.2cm 0; padding-left: 1cm; }
    li { margin: 0.1cm 0; }
    
    /* Compact field groups */
    .field-group { margin-bottom: 0.3cm; }
    .field-group:last-child { margin-bottom: 0; }
    
    /* Print */
    @media print {
      .no-print { display: none !important; }
      .page-break { page-break-after: always; }
      .report-card { break-inside: avoid; page-break-inside: avoid; }
      .report-table tr { page-break-inside: avoid; }
    }
  </style>
</head>
<body>
  {% if show_cover_page %}
  <!-- Optional Cover Page (disabled by default) -->
  <div class="cover-page">
    <div>
      {% if organization.logo and organization.logo.url %}
        <img src="{{ organization.logo.url }}" alt="{{ organization.name }} Logo" class="cover-organization-logo" />
      {% else %}
        <div class="default-logo-placeholder"><h2>{{ organization.name }}</h2></div>
      {% endif %}
    </div>
    <div class="report-title-section">
      <h1 class="report-title">{{ title|default:"Report" }}</h1>
      {% if description %}<p class="report-subtitle">{{ description }}</p>{% endif %}
    </div>
    <div class="report-meta">
      <p><strong>Generated:</strong> {{ generation_timestamp|default:"Not specified" }}</p>
      <p><strong>Organization:</strong> {{ organization.name }}</p>
      {% if filters_summary %}<p><strong>Filters Applied:</strong> {{ filters_summary }}</p>{% endif %}
    </div>
  </div>
  <div class="page-break"></div>
  {% endif %}
  
  {% block content %}{% endblock %}
</body>
</html> 